- id: do_not_disturb
  alias: Do Not Disturb Flow
  description: Adjust devices to Do Not Disturb mode
  mode: queued
  trigger:
    - platform: homeassistant
      event: start
    - platform: state
      entity_id: input_boolean.do_not_disturb
  action:
    - service: script.do_not_disturb_mode

- id: do_not_disturb_while_sleeping_time
  alias: Do Not Disturb while Sleeping Time
  description: Switch Do Not Disturb along with Sleeping Time
  trigger:
    - platform: homeassistant
      event: start
    - platform: state
      entity_id: binary_sensor.sleeping_time
  action:
    - service: input_boolean.turn_{{ states('binary_sensor.sleeping_time') }}
      entity_id: input_boolean.do_not_disturb

- id: do_not_disturb_on_calls
  alias: Do Not Disturb on calls
  description: Switch Do Not Disturb while camera or mics are on
  trigger:
    - platform: state
      entity_id: binary_sensor.wix_macbook_pro_camera_in_use
      for:
        minutes: 1
    - platform: state
      entity_id: binary_sensor.wix_macbook_pro_microphone_in_use
      for:
        minutes: 1
    - platform: state
      entity_id: binary_sensor.home_macbook_pro_camera_in_use
      for:
        minutes: 1
    - platform: state
      entity_id: binary_sensor.home_macbook_pro_microphone_in_use
      for:
        minutes: 1
  action:
    - choose:
        - conditions:
            - condition: state
              entity_id: binary_sensor.sleeping_time
              state: 'off'
          sequence:
            - service: input_boolean.turn_{{ trigger.to_state.state }}
              entity_id: input_boolean.do_not_disturb
